<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<script th:replace="fragments/header :: headElements"></script>
<script>
	$(function() {
		$('[data-toggle="popover"]').popover()
	});

	function init() {
		document.getElementsByClassName("clearInputs").value = "";
	}

	$(document).ready(init);
</script>
<title>Oh My Gacha! - Probability Calculator</title>
</head>
<body>

   <div class="container" style="margin-top: 4em">

      <!--       Website Header -->
      <div class="row"
         style="text-align: center; justify-content: center;">
         <h3>Oh my Gacha! What are my odds?</h3>
      </div>
      <div class="row" style="justify-content: center; margin-top: 2em">
         <h5>What is this?</h5>
      </div>

      <form name="form" action="" method="post">
         <!--       Drop Chance  -->
         <div class="form-group row"
            style="justify-content: center; margin-top: 3em">
            <div class="col-6 col-md-4 col-lg-3">
               <label class="label">Drop chance (From 0-1)</label>
            </div>
            <div class="col-4 col-md-3 col-lg-2">
               <input type="text" th:field="${calculator.probability}"
                  class="form-control" required placeholder="0.0"
                  style="text-align: center">
            </div>
            <span class="alert alert-danger"
               th:if="${#fields.hasErrors('calculator.probability')}"
               th:errors="*{calculator.probability}"></span>
         </div>

         <!--       Cost per pull -->
         <div class="form-group row"
            style="justify-content: center; margin-top: 3em">
            <div class="col-6 col-md-4 col-lg-3">
               <label class="label">Cost per pull</label> <a
                  data-toggle="popover" title="What does this mean?"
                  data-content="Enter the cost of 1 pull/summon, using the in-game currency."
                  class="btn fas fa-question-circle"
                  style="margin-left: 0.5em"></a>
            </div>
            <div class="col-4 col-md-3 col-lg-2">
               <input type="text" th:field="${calculator.pullCost}"
                  class="form-control" required placeholder="0"
                  style="text-align: center">
            </div>
            <span class="alert alert-danger"
               th:if="${#fields.hasErrors('calculator.pullCost')}"
               th:errors="*{calculator.pullCost}"></span>
         </div>

         <!--       Currency Conversion  -->
         <div class="form-group row"
            style="justify-content: center; margin-top: 3em">
            <div class="col-6 col-md-4 col-lg-3">
               <label class="label">Currency Conversion</label>
            </div>
            <div class="input-group col-2">
               <div class="input-group-prepend">
                  <span class="input-group-text" id="pound-sign">£</span>
               </div>
               <input type="text" th:field="${calculator.moneyIn}"
                  class="form-control" required placeholder="0"
                  aria-label="currency" aria-describedby="pound-sign"
                  style="text-align: right">
            </div>
            <span class="alert alert-danger"
               th:if="${#fields.hasErrors('calculator.moneyIn')}"
               th:errors="*{calculator.moneyIn}"></span>
            <div class="col-1">
               <span>gets you</span>
            </div>
            <div class="col-1">
               <input type="text" th:field="${calculator.currencyOut}"
                  class="form-control" required placeholder="0"
                  style="text-align: center">
            </div>
            <span class="alert alert-danger"
               th:if="${#fields.hasErrors('calculator.currencyOut')}"
               th:errors="*{calculator.currencyOut}"></span>
            <div class="col-2">
               <span>in-game currency</span>
            </div>
         </div>
         <div class="form-group row"
            style="justify-content: center; margin-top: 3em">
            <button type="submit" class="btn btn-primary">Calculate</button>
         </div>
      </form>

      <div class="card" th:if="${calculator.attempts != 0}">
         <div class="card-header" style="text-align: center">
            <h4>Results</h4>
         </div>
         <div class="card-body">
            <span>To reach a 99.99% chance of getting your
               desired item at least once, you need a total of</span> <span
               th:text="${calculator.attempts}"
               style="font-weight: bold"></span> <span>pulls.</span> <br>
            <span>At a conversion rate of approximately</span> <span th:if="${calculator.conversionRate < 1}"
               th:text="${#numbers.formatDecimal(calculator.conversionRate, 1, 'COMMA', 6, 'POINT')}"
               style="font-weight: bold"></span> 
               <span th:if="${calculator.conversionRate > 1}"
               th:text="${#numbers.formatDecimal(calculator.conversionRate, 1, 'COMMA', 2, 'POINT')}"
               style="font-weight: bold"></span>
               <span>GBP per 1
               unit of the in-game currency, this would cost you
               approximately £</span> <span th:text="${calculator.totalCost}"
               style="font-weight: bold"></span>
         </div>
      </div>
</body>
</html>